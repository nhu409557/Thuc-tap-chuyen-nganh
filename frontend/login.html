<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Đăng nhập</title>
  <link rel="stylesheet" href="assets/css/reset.css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="assets/css/app.css" />
</head>
<body class="bg-gray-100">

  <div id="site-header"></div>

  <main class="flex-1 flex items-center justify-center px-4 sm:px-6 lg:px-8 py-12">
    <div class="w-full max-w-md">
      <div class="bg-white rounded-lg border border-gray-300 p-8 shadow-md">
        <h1 class="text-3xl font-bold mb-2">Đăng nhập</h1>
        <p class="text-gray-500 mb-8">Truy cập tài khoản của bạn tại TechHub</p>
        
        <form id="login-form" class="space-y-4">
          <div>
            <label class="block text-sm font-medium mb-2">Email</label>
            <input 
              type="email" 
              name="email"
              placeholder="your@email.com" 
              class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
              required
            />
          </div>
          
          <div>
            <label class="block text-sm font-medium mb-2">Mật khẩu</label>
            <div class="relative">
              <input 
                id="password-input"
                type="password" 
                name="password"
                placeholder="••••••••" 
                class="w-full px-4 py-2 pr-12 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" 
                required
              />
              <button
                type="button"
                id="toggle-password"
                class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-700 text-sm select-none"
                aria-label="Hiện/ẩn mật khẩu"
              >
                <span id="toggle-password-text" class="text-xs font-medium">Hiện</span>
              </button>
            </div>
          </div>
          
          <div class="flex items-center justify-between text-sm">
            <label class="flex items-center gap-2">
              <input id="remember-me" type="checkbox" class="w-4 h-4"/>
              <span>Nhớ tôi</span>
            </label>
            <a class="text-blue-600 hover:underline" href="forgot-password.html">Quên mật khẩu?</a>
          </div>
          
          <button 
            type="submit" 
            class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:opacity-90 disabled:opacity-50 transition"
          >
            Đăng nhập
          </button>
        </form>

        <div class="mt-6 text-center text-sm">
          <span class="text-gray-500">Chưa có tài khoản? </span>
          <a class="text-blue-600 font-semibold hover:underline" href="register.html">Đăng ký ngay</a>
        </div>
      </div>
    </div>
  </main>
  <div id="site-footer"></div>

  <script type="module" src="assets/js/main.js"></script>
  <script type="module" src="assets/js/auth.js"></script>

  <!-- Script toggle mật khẩu -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Toggle mật khẩu
      const passwordInput = document.getElementById('password-input');
      const toggleBtn = document.getElementById('toggle-password');
      const toggleText = document.getElementById('toggle-password-text');

      if (passwordInput && toggleBtn && toggleText) {
        toggleBtn.addEventListener('click', function () {
          const isHidden = passwordInput.type === 'password';
          passwordInput.type = isHidden ? 'text' : 'password';
          toggleText.textContent = isHidden ? 'Ẩn' : 'Hiện';
        });
      }

      // Nhớ email
      const loginForm = document.getElementById('login-form');
      const emailInput = loginForm ? loginForm.querySelector('input[name="email"]') : null;
      const rememberCheckbox = document.getElementById('remember-me');

      // Key riêng cho project TechHub
      const STORAGE_KEY = 'techhub_login_email';

      // 1. Khi load trang, nếu localStorage có email thì fill vào
      if (emailInput) {
        const savedEmail = localStorage.getItem(STORAGE_KEY);
        if (savedEmail) {
          emailInput.value = savedEmail;
          if (rememberCheckbox) rememberCheckbox.checked = true;
        }
      }

      // 2. Khi submit form, lưu / xóa email tùy theo checkbox
      if (loginForm && emailInput && rememberCheckbox) {
        loginForm.addEventListener('submit', function () {
          const email = emailInput.value.trim();
          if (rememberCheckbox.checked && email) {
            localStorage.setItem(STORAGE_KEY, email);
          } else {
            localStorage.removeItem(STORAGE_KEY);
          }
          // Không preventDefault ở đây để auth.js vẫn xử lý login bình thường
        });
      }
    });
  </script>
</body>
</html>
